# S04 – eda_cli: мини-HTTP-сервис для CSV

Небольшой HTTP-сервис для базового анализа CSV-файлов.
Используется в рамках Семинара 04 курса «Инженерия ИИ».

## Требования

- Python 3.11+
- [uv](https://docs.astral.sh/uv/) установлен в систему

## Инициализация проекта

В корне проекта (eda-cli):

```bash
uv sync
```

Эта команда:

- создаст виртуальное окружение `.venv`;
- установит зависимости из `pyproject.toml`;
- установит сам проект `eda-cli` в окружение.

## Работа с HTTP-сервисом

### Запуск локального сервера

```bash
uv run uvicorn eda_cli.api:app --reload --port 8000
```

Параметры:

- `--reload` – сервер будет обновляться при изменении в коде;
- `--port` – выбор порта.

После чего нужно перейти по адресу `http://127.0.0.1:8000/`

### Проверка работы сервера

Перейдя по `http://127.0.0.1:8000/health` получим овтет:
```
{
  "status": "ok",
  "service": "dataset-quality",
  "version": "0.2.0"
}
```
Значит сервер запущен и готов к работе

### Использование сервиса

Удобнее всего посмотреть и протестировать функционал сервиса на вкладке `http://127.0.0.1:8000/docs`

В этом сервисе реализованы следующие эдпоинты:

1. Эндпоинт `GET /health`:

   - отвечает кодом `200`;
   - возвращает JSON со статусом сервиса.
2. Эндпоинт `POST /quality`:

   - принимает JSON по схеме `QualityRequest`;
   - возвращает JSON по схеме, совместимой с `QualityResponse` (включая `ok_for_model`, `quality_score`, `latency_ms`, `flags`);
   - логика предсказания зависит от входных параметров.
3. Эндпоинт `POST /quality-from-csv`:

   - принимает CSV-файл;
   - использует EDA-ядро (`summarize_dataset`, `missing_table`, `compute_quality_flags`);
   - возвращает `quality_score` и набор флагов качества, завязанных на вашей реализации HW03;
   - корректно обрабатывает ошибки чтения и пустой CSV (код `400`).
4. Эндпоинт `POST /quality-flags-from-csv`:

   - принимает CSV-файл;
   - использует EDA-ядро (`summarize_dataset`, `missing_table`, `compute_quality_flags`);
   - возвращает набор булевых флагов качества, завязанных на реализации HW03;
   - корректно обрабатывает ошибки чтения и пустой CSV (код `400`).
5. Эндпоинт `POST /head`:

   - принимает CSV-файл и число n строчек (по умолчанию `5`);
   - возвращает строку с названиями столбцов и первыми n чтроками загруженного датафрейма
   - корректно обрабатывает ошибки чтения и пустой CSV (код `400`).


